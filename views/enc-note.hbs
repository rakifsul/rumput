<div class="row g-4">
    <div class="col-12 col-md-8 d-md-flex flex-column">
        <div class="flex-grow-1">
            <input id="password" type="password" name="password" class="form-control" placeholder="Your password"
                aria-label="Password" required>
            <br>
            <textarea class="form-control" id="content" name="links" style="height:85%;" placeholder="Your input note"></textarea>
            <br>
            <div class="row">
                <div class="col-12 col-md-4 mb-2">
                    <button id="save" class="btn btn-dark w-100">Save</button>
                </div>

                <div class="col-12 col-md-4 mb-2">
                    <button id="load" class="btn btn-dark w-100">Load</button>
                </div>

                <div class="col-12 col-md-4 mb-2">
                    <button id="clear" class="btn btn-dark w-100">Clear</button>
                </div>
            </div>
            <br>
            {{!-- <div class="row">
                <div class="col-12 col-md-12">
                    <button id="clear" class="btn btn-dark w-100">Clear</button>
                </div>
            </div> --}}
        </div>
    </div>
    <div class="col-12 col-md-4 border-separator flex-grow-1">
        <h3 class="text-primary">Info</h3>
        <p>Write a note on the textarea, enter the password, then click "Save".</p>
        <p>You can decrypt the notes by entering the password again and click "Load"</p>
        <p>If you close and reopen this app, then you just need to enter the password and click "Load".</p>
        <p>To clear both the password and the note temporarily, click "Clear".</p>
    </div>
</div>

<script>
    $(document).ready(function () {
        $("#clear").click(function () {
            $("#content").val("");
            $("#password").val("");
        });

        $("#save").click(async function (e) {
            if (confirm("WARNING! Notes will be overwritten. Is it OK?")) {
                console.log("User chooses OK");

                //
                const password = $("#password").val();
                const content = $("#content").val();

                const res = await fetch(`/encrypt-note`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        password: password,
                        content: content
                    })
                });

                const jsn = await res.json();
            } else {
                console.log("User chooses Cancel");
            }

            $("#content").val("");
            $("#password").val("");
        });

        $("#load").click(async function (e) {
            const password = $("#password").val();

            const res = await fetch(`/decrypt-note`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    password: password
                })
            });

            const output = await res.json();

            if(output.error){
                alert("WARNING! Password didn't match.")
            }

            $("#content").val(output.content)
        });
    })
</script>